
# Crypto Exchange
Simple application for depicting a trading platform. 
It consists of 4 projects - CryptoExchange.Common, CryptoExchange.Common.Tests, CryptoExchange.ConsoleApp, CryptoExchange.WebApp

# CryptoExchange.Common
It consists of a simple implementation for reading json files, ordering the data by type and generating corresponding output.

 - Services
	 - IExchangeService - its responsibility is to read the json files and generates a list of exchange objects
	 - IOrderService - gets all buy/sell orders needed for processing and generates a dictionary where data is saved.
	 - ITradingService - its responsibility is to execute a trading, the data from the order service is being process and a list of dto objects is been returned.
 - Providers
	 - IFileProvider - gets all files in a specified folder
 - Mappers
	 - IExchangeFileMapper - it deserializes a json file to an exchange object
 - Service Collection Extensions
	 - AddTradingServices - consists of all registrations of all required services

For simplicity when buying/selling crypto the data is processed as follows: 

 1. Gets all sorted data - each dictionary entry has an object (exchange id, available crypto) as a key and the corresponding sorted list of orders 
 2. The dictionary keys - are sorted by availablility (available crypto)
 3. The output is generated by iteration over the dictionary's keys and selecting orders until either available funds are finished (goes to the next key) or the number of btc is reached.

# CryptoExchange.Common.Tests
In this project is demostrated how to unit test different services from the CryptoExchange.Common project.
For testing it is used NUint, NSubstitute & FluentAssertions.

# CryptoExchange.ConsoleApp
To reduce complexity DI support is added to the console application. The trading services are added from the CryptoExchange.Common project.

    IServiceCollection services = new ServiceCollection();
    services.AddTradingServices();

The app requires three arguments

 1. Source (-s , --source) - path to the folder where json files are
 2. Btc (-b, --btc) - number of BTC to be traded
 3. Action (-a, --action) - trading action Sell or Buy

Example of how to execute 
 
    CryptoExchange.ConsoleApp.exe --source C:\Temp --btc 10 --action sell
    CryptoExchange.ConsoleApp.exe -s C:\Temp -b 10 -a sell

The output is logged in the console in from of json. It consists the following properties:

    {"ExchangeId":"exchange-01","Id":"6e9fe255-a776-4965-9bf4-9f076361f5cb","Amount":0.01,"Price":57226.46}

# CryptoExchange.WebApp
This is a small web application based on Minimal APIs and hosted in docker. The common trading services are added from CryptoExchange.Common project. Additionally, swagger support is introduced. 

 1. Configuration
	 1. Settings - represents the "Settings" section in the appsettings.json, there one can specify the source path of the json files.
 2. InputData
	 1. For simplicity all json files are added to the project so that they can be available under docker out of the box. 
 3. Services
	 1. ISalesService - An orchestrator service for the IExchangeService and ITradingService, it generates the output result

In order to start the application one should use "docker-compose up" under "\src\CryptoExchange" folder.
The user can then go to Swagger UI (/swagger) where two get requests are listed. One can choose between buying or selling BTC. 
To try out a request one should do the following: 

 1. Select a request from the list
 2. Click on "Try it out" button on the right hand side
 3. Provide a number of BTC for the parameter "numberOfBtc"
 4. Click on "Execute"

 The output is then visualized in the response body as a json object.
